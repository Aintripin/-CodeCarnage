
Рассмотрим следующее:

В `useEffect` у нас прилетает какая-то ошибка

![[Pasted image 20241028162734.png]]

и мы её никак не отработали, в `try/catch` не обернули. Т.е. просто пропустили

Вот у нас ошибка вылетела:

![[Pasted image 20241028162817.png]]

И приложение наебнулось полностью


#### Для подобного рода ошибок у React есть механизм, который называется `ErrorBoundary`

В нашем случае - это будет Provider, который глобально будет оборачивать всё приложение. Поэтому и создаём его в папке `providers`


```URL:
https://legacy.reactjs.org/docs/error-boundaries.html
```

говорит:

![[Pasted image 20241028165357.png]]

Вот верхнюю пачку кода копируем

Далее вот так:

![[Pasted image 20241028165517.png]]


Нам ещё типы нужно проставить:

![[Pasted image 20241028165640.png]]

Вот эту строчку:

![[Pasted image 20241028165730.png]]

Заменяем на простой `clg` вместо `logErrorToMyService`

Ещё добавим интерфейсы:

![[Pasted image 20241028165853.png]]

Ещё вот так укажем тип пропсов:

![[Pasted image 20241028165940.png]]

И в `render()` дестркутуризируем и достанем нужные поля:


![[Pasted image 20241028170958.png]]

Раньше мы писали с хуком `useTranslate`в функциональных компонентах. В классовых такое не прокатит . Есть такой HOC - обёртка, которая называется `withTranslation`

![[Pasted image 20241028171213.png]]

Аргументом сама функция принимает все те же аргументы, которые принимает хук `useTranslation`, а сам error boundary передаём в `HOC` вот так:

![[Pasted image 20241028171316.png]]


Но мы так делать не будем

![[artworks-VWr8i69n68tKATlz-mJDF9Q-t500x500.jpg]]

Интернационализации в классовом компоненте не будет, `ErrorBoundary` принял Ислам

В нашем случае в качестве возвращаемого значения мы сделаем отдельный компонент, но пока оставим так:

![[Pasted image 20241028171720.png]]


Теперь импортируем всё это в PublicAPI


![[Pasted image 20241028172018.png]]


Теперь корневой компонент `index.tsx` обвернём в `errorBoundary`:

![[Pasted image 20241028172057.png]]

Теперь, если чё, у нас выбрасывает ошибку вот так:

![[Pasted image 20241028172118.png]]

Приложение теперь не тупо падает, а мы показываем какой-то запасной интерфейс

#### Теперь для этого запасного интерфейса создадим отдельный компонент

![[Pasted image 20241028172234.png]]


![[Pasted image 20241028172327.png]]


Создадим функцию с кнопкой, с помощью которой будем перезагружать страницу:

![[Pasted image 20241028172603.png]]

Теперь остаётся компонент вернуть из `errorBoundary`:

![[Pasted image 20241028173554.png]]


7:24

